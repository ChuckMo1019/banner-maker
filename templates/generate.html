<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <title>SVG Banner Generator</title>
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v3.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://rawgithub.com/t0m/select2-bootstrap-css/bootstrap3/select2-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.7.0/spectrum.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.7.0/spectrum.js"></script>

    <!--Fonts!-->
    <link href='https://fonts.googleapis.com/css?family=Questrial|Rambla|Alegreya+Sans+SC|Alfa+Slab+One|Source+Sans+Pro|Nixie+One|Glegoo|Dosis|Abel|Bubblegum+Sans|Patrick+Hand|Fira+Sans|Crafty+Girls|Noto+Sans|Domine|Droid+Sans|Cantata+One|Permanent+Marker|Just+Another+Hand|Jockey+One|Signika+Negative|Lato|Arvo|Antic+Slab|Cabin|Playfair+Display|Fauna+One|ABeeZee|BenchNine|Viga|Neuton|Sorts+Mill+Goudy|Economica|News+Cycle|Michroma|Lora|Niconne|PT+Sans|Poiret+One|Acme|Armata|Cherry+Cream+Soda|Syncopate|PT+Sans+Narrow|Ropa+Sans|Cabin+Condensed|Tinos|Philosopher|Bad+Script|Istok+Web|Arimo|Quicksand|Paytone+One|Oleo+Script|Noto+Serif|Ubuntu|Gudea|Marck+Script|Droid+Sans+Mono|Montserrat+Alternates|Josefin+Sans|Bitter|Carrois+Gothic|PT+Serif|Limelight|Lobster|Gentium+Basic|Kreon|Fugaz+One|Waiting+for+the+Sunrise|Monda|Reenie+Beanie|Anton|Crete+Round|Shadows+Into+Light|Rokkitt|Josefin+Slab|Fredoka+One|Russo+One|Libre+Baskerville|Copse|Racing+Sans+One|Walter+Turncoat|Sigmar+One|Source+Code+Pro|Gloria+Hallelujah|Fontdiner+Swanky|Calligraffitti|Exo|Asap|Tangerine|Days+One|Cantarell|Antic|Muli|Great+Vibes|Alegreya+Sans|Ubuntu+Condensed|EB+Garamond|Droid+Serif|Molengo|Jura|Allerta|Dancing+Script|Montserrat|Electrolize|Architects+Daughter|Open+Sans|Open+Sans+Condensed:300|Coda|Actor|Merriweather|Varela|Didact+Gothic|Chewy|Berkshire+Swash|Scada|Orbitron|Abril+Fatface|Titillium+Web|Bangers|Roboto+Condensed|Ruda|Marvel|Merriweather+Sans|Sanchez|Enriqueta|Changa+One|Archivo+Narrow|Oxygen|Archivo+Black|Hind|Vollkorn|Nobile|Passion+One|Patua+One|Audiowide|Hammersmith+One|Cookie|Nunito|Quattrocento+Sans|Pinyon+Script|Sacramento|Exo+2|Ultra|Raleway|Amiri|Vidaloka|Slabo+27px|Kaushan+Script|Roboto|Inconsolata|Pacifico|Righteous|Carme|Squada+One|Julius+Sans+One|Signika|Cuprum|Source+Serif+Pro|PT+Sans+Caption|Lusitana|Courgette|Shadows+Into+Light+Two|Homenaje|Play|Noticia+Text|Black+Ops+One|IM+Fell+English|Indie+Flower|Alegreya|Yanone+Kaffeesatz|Comfortaa|Homemade+Apple|Old+Standard+TT|Share|Cutive|Advent+Pro|Sintony|Playball|Roboto+Slab|Goudy+Bookletter+1911|Pathway+Gothic+One|Karla|Playfair+Display+SC|Oswald|Quattrocento|Maven+Pro|Alice|Amatic+SC|Special+Elite|Satisfy|Basic|Bree+Serif|Coming+Soon|Damion|Bevan|Amaranth|Pontano+Sans|Varela+Round|Francois+One|Fjalla+One|Volkhov|Crimson+Text|Doppio+One|Chivo|Voltaire|Luckiest+Guy|Cardo|Gentium+Book+Basic|Covered+By+Your+Grace|Handlee|Rock+Salt|Nothing+You+Could+Do|Lobster+Two|Cinzel' rel='stylesheet' type='text/css'>
    <style>
      body {
          font-family: 'Roboto', sans-serif;
      }
    </style>
  </head>
  <body>
    <div style="margin-top:20px" id="banner"></div>

   <!-- Text Input -->

<div class="well">
    <div class="row" style="margin-left:20px">
        <hr>
        <div class="col-md-10" style="margin-top:10px">
           <input type="text" class="form-control" id="hiddentext" value="{{ current_text }}">
        </div>
   </div>

    <!-- Font Selector -->
    <div class="row" style="margin-left:20px">
        <div class="col-md-4">
              <h3>Font</h3>
                  <select name="hiddenfont" id="hiddenfont" aria-controls="hiddenfont" class="form-control input-sm">                
                    {% for font in fonts %}
                   <option value="{{ font }}">{{ font }}</option>
                    {% endfor %}
		  </select>
        </div>
        <div class="col-md-6" style="font-size: 50px; margin-top:30px; font-family: '{{ current_font }}', sans-serif">{{ current_font }}</div>

    <!-- Color Choosers -->
        <div class="col-md-2">
            <h3>Colors</h3>
                <input name="color1" type='text' id="color1" value="{{ color }}" class="form-control input-sm"/>
                <input name="color2" type='text' id="color2" value="{{ color_hidden }}" class="form-control input-sm"/>
        </div>
    </div>

<!-- Buttons-->
<div class="row"  style="margin-left:35px; margin-top:20px">
    <button class="btn btn-success" id="save_as_svg" value="" onclick="save_svg()">save svg (no fonts)</button>

    <!--GET SVG CODE-->
    <a href="#collapseCode" data-toggle="collapse" aria-expanded="false" aria-controls="collapseCode">
      <button class="btn btn-success">get svg code (fonts)</button>
    </a>
        <div class="collapse" id="collapseCode">
            <div class="well" style="background:white" id="codearea">
            </div>
        </div>
    </div>
</div>
    <script type="text/javascript">

     $(document).ready(function() {

      // Fill in the code area with the SVG code
      var codearea = document.getElementById('codearea');
      var code = document.getElementById("banner")
      codearea.textContent = code.innerHTML;

      // On any button click, change the input data
        $('input[type=text]').change(function() {
          var text = document.getElementById('hiddentext').value;
          var font = document.getElementById('hiddenfont').value;
          var color1 = document.getElementById('color1').value.replace('#',''); 
          var color2 = document.getElementById('color2').value.replace('#',''); 
          url =  "/" + font + "/" + color1 + "/" + color2 + "/" + text
          window.location.replace(url)       
        });
        $('select').change(function() {
          var text = document.getElementById('hiddentext').value;
          var font = document.getElementById('hiddenfont').value;
          var color1 = document.getElementById('color1').value.replace('#',''); 
          var color2 = document.getElementById('color2').value.replace('#',''); 
          url =  "/" + font + "/" + color1 + "/" + color2 + "/" + text
          window.location.replace(url)       
        });
     });

     $('#hiddenfont').select2();

     $("#color1").spectrum({
         preferredFormat:"hex",
         color: "{{ color }}"
     });
     $("#color2").spectrum({
         preferredFormat:"hex",
         color: "{{ color_hidden }}"
     });

   // Generate graphic with d3

var width = 1600,
    height = 100

var svg = d3.select("#banner").append("svg")
    .attr("width", width)
    .attr("height", height)

// the data will be appended here
raw = {"letters":[{{ letters|safe }}],
       "colors":[{{ colors|safe }}],
       "x":[{{ xcoords|safe }}],
       "y":[{{ ycoords|safe }}]};

data = []
for (i = 0; i < raw.letters.length; i++) { 
  data.push({"letter":raw.letters[i],"color":raw.colors[i],"x":+raw.x[i],"y":+raw.y[i]});
}

var text = svg.selectAll("text")
    .data(data)
    .enter()
    .append("text");

var textLabels = text
                 .attr("x", function(d,i) { return d.x; })
                 .attr("y", function(d,i) { return d.y + 30; })
                 .style("fill",function(d){ return d.color })
                 .style("font-family","'{{ current_font }}', sans-serif")
                 .text( function (d) { return d.letter })

//Vanessa's Hacky save svg function!
function save_svg(evt) {
    var svg = document.getElementsByTagName("svg");
    var serializer = new XMLSerializer();
    var svg_blob = new Blob([serializer.serializeToString(svg[0])],
                            {'type': "image/svg+xml"});
    var url = URL.createObjectURL(svg_blob);
    var svg_win = window.open(url, "svg_win");
}

</script>
  </body>
<footer>
<a style="float:right; margin-right:20px" target="_blank" href="https://vsoch.github.io">vsoch</a>
</footer>
</html>
